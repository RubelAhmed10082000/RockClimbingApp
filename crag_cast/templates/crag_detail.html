<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ crag.crag_name }} - Climbing Crag Details</title>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="static/css/main.css">
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="{{ url_for('static', filename='js/crag_detail.js') }}"></script>
</head>
<body>
    <div class="container">
        <a href="/" class="back-link">‚Üê Back to Crags List</a>

        <div class="crag-header">
            <h1>{{ crag.crag_name }}</h1>
            <p>{{ crag.crag_county }}, {{ crag.crag_country }}</p>
        </div>

        <div class="crag-grid">
            <div class="main-content">
                <div class="card">
                    <h2 class="card-title">Location & Information</h2>
                    <div class="info-grid">
                        <div class="info-item">
                            <div class="info-item-label">Rock Type</div>
                            <div class="info-item-value">{{ crag.crag_rocktype }}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">County</div>
                            <div class="info-item-value">{{ crag.crag_county }}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">Country</div>
                            <div class="info-item-value">{{ crag.crag_country }}</div>
                        </div>
                        <div class="info-item">
                            <div class="info-item-label">Coordinates</div>
                            <div class="info-item-value">{{ crag.crag_latitude }}, {{ crag.longitude }}</div>
                        </div>
                    </div>

                    <h3 class="card-title">Location Map</h3>
                    <div id="map" class="map-container"></div>

                    {% if crag.crag_description %}
                    <h3 class="card-title">About this Crag</h3>
                    <p>{{ crag.crag_description }}</p>
                    {% endif %}
                </div>

                {% if crag.crag_routes %}
                <div class="card" style="margin-top: 2rem;">
                    <h2 class="card-title">Routes ({{ crag.crag_routes|length }})</h2>
                    <div class="routes-controls">
                        <div class="routes-per-page">
                            <label for="routesPerPage">Routes per page:</label>
                            <select id="routesPerPage">
                                <option value="10">10</option>
                                <option value="25">25</option>
                                <option value="50">50</option>
                                <option value="100">100</option>
                            </select>
                        </div>
                        <div class="routes-search">
                            <input type="text" id="routeSearch" placeholder="Search routes...">
                        </div>
                    </div>
                    <ul class="routes-list" id="routesList">
                        {% for route in crag.crag_routes %}
                        <li class="route-item">
                            <div class="route-name">
                                {{ route.name }}
                            </div>
                            <div class="route-info">
                                {% if route.type %}
                                <span class="route-type">Climbing Style: {{ route.type }}</span>
                                {% endif %}
                                {% if route.safety and route.safety|lower != 'nan' %}
                                <span class="route-safety">Safety Grade: {{ route.safety }}</span>
                                {% endif %}
                                {% if route.difficulty %}
                                <span class="route-difficulty">Difficulty Grade: {{ 'Not available' if route.difficulty|lower == 'nan' else route.difficulty  }}</span>
                                {% endif %}
                            </div>
                            {% if route.description %}
                            <div class="route-description">{{ route.description }}</div>
                            {% endif %}
                        </li>
                        {% endfor %}
                    </ul>
                    <div class="routes-pagination">
                        <button id="prevPage" class="pagination-btn" disabled>&larr; Previous</button>
                        <span id="pageInfo">Page <span id="currentPage">1</span> of <span id="totalPages">1</span></span>
                        <button id="nextPage" class="pagination-btn" disabled>Next &rarr;</button>
                    </div>
                </div>
                {% else %}
                <div class="card" style="margin-top: 2rem;">
                    <h2 class="card-title">Routes</h2>
                    <p class="no-routes">No routes available for this crag.</p>
                </div>
                {% endif %}
            </div>
        <div class="sidebar" style="width:267.33; height: 330px;">
                <h2 class="card-title">Current Weather</h2>
                <div id="weatherForecast"
                style= "width: 300.33px; height: 329; overflow: auto; display: block;"></div>
            </div>

                {% if crag.access %}
                <div class="card" style="margin-top: 2rem;">
                    <h2 class="card-title">Access Information</h2>
                    <p>{{ crag.access }}</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

   